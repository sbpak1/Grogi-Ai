# Grogi AI 백로그

## 태스크 목록

### 인프라/배포

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| IF-01 | GitHub 모노레포 생성 (frontend/ backend/ ai/ 구조) + .gitignore + README | Critical | Backend | Day 1 | - | 12절 프로젝트 구조 |
| IF-02 | API 키 발급 — 카카오 REST API 키/Secret/JS 키, OpenAI API 키, Tavily API 키 | Critical | Backend | Day 1 | - | 13절. 팀원 간 DM 공유, .env 관리 |
| IF-03 | ★ Day 2 전체 스펙 합의 — ① Node↔Python 통신 (POST /agent/chat 요청/응답, SSE 8종 이벤트 data 포맷, 헬스체크, 내부 인증, 끊김 처리) ② SSE DB 저장 전략 (메모리 버퍼 → done 시 트랜잭션 저장) ③ 프론트↔백엔드 API (4개 엔드포인트 + 세션 생성 방식) ④ 데이터 포맷 (현실회피지수 JSON + 공유카드 JSON) | Critical | All | Day 2 | - | 8.1~8.4절, 10절, 3.3~3.4절. 미합의 시 Day 3부터 병목 |
| IF-04 | Railway 배포 (Backend + AI + PostgreSQL) + 환경 변수 등록 | High | Backend | Day 5~6 | BE-22, AG-22 | 7절, 13절 |
| IF-05 | Railway 내부 통신 확인 (Node.js → Python AI_SERVER_URL) | High | Backend | Day 5~6 | IF-04 | 7절 |
| IF-06 | Cloudflare Pages 배포 (GitHub 연동) | High | Frontend | Day 5~6 | - | 7절 |
| IF-07 | 프론트 → 백엔드 → AI E2E 통신 테스트 (배포 환경) | Critical | All | Day 6 | IF-04, IF-06 | |

### AI 에이전트

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| AG-01 | Python FastAPI 프로젝트 초기 세팅 (app/agent, app/tools, app/prompts 폴더 구조 + requirements.txt) | Critical | AI | Day 1~2 | - | 12절 프로젝트 구조 |
| AG-02 | LangGraph StateGraph 기본 그래프 구조 설계 및 구현 (START→crisis_check→analyze_input→select_tools→execute_tools→generate_response→END) | Critical | AI | Day 2 | - | 3.1절 그래프 구조 |
| AG-03 | crisis_check 필수 선행 노드 — 1차 키워드 필터링 (자살, 죽고싶, 자해, 살고싶지않, 극단적 선택 등) + 2차 GPT-4o 우회 표현 문맥 분석 | Critical | AI | Day 2 | - | 3.1절. 고정 선행 노드 |
| AG-04 | crisis_check 위기 감지 시 응답 — 팩폭 모드 해제 + 따뜻한 톤 전환 + 핫라인 안내 (자살예방 1393, 정신건강위기 1577-0199, 생명의전화 109) | Critical | AI | Day 2 | AG-03 | 3.1절. 핫라인은 상수로 관리 |
| AG-05 | 시스템 프롬프트 설계 — 기본 페르소나("솔직한 형/누나") + 핵심 규칙 (공감 금지, 현실 진단 필수, 데이터 기반, 액션 플랜 3개 필수, 인신공격 금지) | Critical | AI | Day 2 | - | 14.1~14.2절 |
| AG-06 | 레벨별 프롬프트 변형 (순한맛: 존중어 / 매운맛: 직설적 / 핵불닭맛: 반말+직설) | High | AI | Day 2 | AG-05 | 14.3절 |
| AG-07 | OpenAI API 검열 대응 — 팩폭 강도 조절 프롬프트 다층 설계 | High | AI | Day 3~4 | AG-05 | 18절 최고 영향도 리스크 |
| AG-08 | analyze_input 노드 — 카테고리 자동 판별 (커리어/연애/재정/자기개발/기타) | Medium | AI | Day 3 | AG-02 | 3.2절 Step 1 |
| AG-09 | select_tools 노드 — AI가 입력 분석 결과에 따라 필요한 도구를 자율 선택 | High | AI | Day 2~3 | AG-02 | 3.2절 Step 2 |
| AG-10 | search_web Function (Tavily Search API 연동) | Critical | AI | Day 2 | AG-02 | 3.3절, 3.5절. 무료 1,000회/월 |
| AG-11 | get_statistics Function (search_web 활용, 통계청/고용노동부/한국은행/사람인 등 신뢰 출처 우선) | High | AI | Day 2~3 | AG-10 | 3.3절, 3.5절 |
| AG-12 | calculate_reality_score Function — 5가지 기준 각 0~20점, 합산 0~100점 | High | AI | Day 2~3 | AG-02 | 3.4절 |
| AG-13 | generate_share_card Function (summary + score + actions 3개 JSON 반환) | Medium | AI | Day 3 | AG-12 | 3.3절 |
| AG-14 | FastAPI SSE 스트리밍 엔드포인트 (POST /agent/chat) | Critical | AI | Day 2~3 | AG-02 | 8.1절 |
| AG-15 | SSE 이벤트 발행 — 정해진 순서 (status→section{diagnosis}→token→section{factcheck}→token→section{actionplan}→token→score→share_card→done) | Critical | AI | Day 2~3 | AG-14 | 8.2절 + 9절 스트리밍 순서 |
| AG-16 | crisis 이벤트 발행 — 위기 감지 시 안전 응답 + 핫라인 전달 | Critical | AI | Day 3 | AG-03, AG-14 | 8.2절 |
| AG-17 | error 이벤트 발행 — 도구 실패/에러 시 (code + message) | High | AI | Day 3 | AG-14 | 8.2절 |
| AG-18 | GET /agent/health 헬스체크 엔드포인트 | Medium | AI | Day 3 | - | 8.4절 |
| AG-19 | Function Calling 실패 시 폴백 — 학습 데이터 기반 + "실시간 데이터 없이 응답" 안내 | Medium | AI | Day 5 | AG-10 | 8.4절, 18절 |
| AG-20 | Tavily 할당량 추적 + 소진 임박 시 사전 폴백 전환 | Medium | AI | Day 5 | AG-10, AG-19 | 18절 |
| AG-21 | AI 서버 요청 인증 (Node.js에서만 호출 가능하도록 제한) | Medium | AI | Day 3 | AG-14, IF-03 | Day 2 합의 결과 반영 |
| AG-22 | AI 서버 Dockerfile (Railway 배포용) | High | AI | Day 3 | - | 7절 |
| AG-23 | generate_response 응답 구조 강제 — 팩폭→팩트체크→액션플랜 3단 구조 | High | AI | Day 3 | AG-05, AG-02 | 2절 차별점 |

### Backend

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| BE-01 | Node.js + Express 프로젝트 초기 세팅 (TypeScript, 12절 폴더 구조) | Critical | Backend | Day 1~2 | - | |
| BE-02 | Prisma 스키마 정의 — users, sessions, messages, share_cards (6절) | Critical | Backend | Day 2 | BE-01 | 6절 DB 스키마 |
| BE-03 | PostgreSQL + Prisma 마이그레이션 + Railway DB 연결 | Critical | Backend | Day 2 | BE-02 | |
| BE-04 | CORS 설정 — Cloudflare Pages 프론트 도메인 허용 | Critical | Backend | Day 2 | BE-01 | |
| BE-05 | POST /api/auth/kakao — 인가 코드 → Access Token 교환 → 사용자 조회/저장 → JWT 발급 | Critical | Backend | Day 3 | BE-03 | 4.5.1절 |
| BE-06 | JWT 인증 미들웨어 (24시간 만료, Payload: user_id/kakao_id/nickname) | Critical | Backend | Day 3 | BE-05 | 4.5.1절 JWT 정책 |
| BE-07 | 세션 생성 API — sessions 레코드 생성 (user_id, category, level) [인증] | Critical | Backend | Day 3 | BE-06, IF-03 | Day 2 합의: 세션 생성 방식 |
| BE-08 | POST /api/chat — 팩폭 요청 SSE 중계 [인증] | Critical | Backend | Day 3 | BE-06, AG-14 | 8.3절 |
| BE-09 | user 메시지 저장 — /api/chat 시 messages에 role="user"로 즉시 저장 | High | Backend | Day 3 | BE-07, BE-08 | |
| BE-10 | 히스토리 조립 → AI 서버 전달 (세션 messages 조회 → history [{role, content}]로 Python 전송) | High | Backend | Day 3 | BE-07, BE-08 | 8.1절 history 필수 |
| BE-11 | SSE 중계 — token/status/section/crisis: pass-through + token은 메모리 버퍼 누적 | High | Backend | Day 3 | BE-08 | 8.3절 |
| BE-12 | SSE 중계 — score/share_card: 프론트 전달 + 메모리 버퍼 임시 보관 | High | Backend | Day 3 | BE-08 | 8.3절. FK 문제로 done 전 DB 저장 불가 |
| BE-13 | SSE 중계 — done: 버퍼 데이터 한 트랜잭션 DB 저장 (messages INSERT → score UPDATE → share_cards INSERT) → SSE 종료 | Critical | Backend | Day 3 | BE-11, BE-12 | 8.3절. 메모리 버퍼 방식 |
| BE-14 | SSE 중계 — error: 에러 로깅 → 프론트 전달 | High | Backend | Day 3 | BE-08 | 8.3절 |
| BE-15 | SSE 연결 끊김 처리 — disconnect 감지 → Python 스트림 정리 | High | Backend | Day 4 | BE-08 | 좀비 연결 방지 |
| BE-16 | GET /api/chat/{sessionId} — 대화 히스토리 조회 [인증] | Medium | Backend | Day 3~4 | BE-06 | 10절 |
| BE-17 | POST /api/share — 공유 카드 데이터 조회 [인증] | Medium | Backend | Day 3~4 | BE-13 | 10절 |
| BE-18 | AI 서버 헬스체크 30초 간격 호출 | Medium | Backend | Day 4 | AG-18 | 8.4절 |
| BE-19 | 팩폭 요청 타임아웃 60초 + "응답 생성 시간 초과" 안내 | High | Backend | Day 4 | BE-08 | 8.4절 |
| BE-20 | OpenAI API 일일 사용량 제한 + 캐싱 | Medium | Backend | Day 5 | BE-08 | 18절 |
| BE-21 | 환경 변수 설정 (.env, GitHub 커밋 금지, DM 공유) | High | Backend | Day 2~3 | - | 13절 |
| BE-22 | Backend Dockerfile (Railway 배포용) | High | Backend | Day 3 | - | 7절 |

### Frontend

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| FE-01 | React + Vite + TypeScript 초기 세팅 (Tailwind CSS, Zustand) | Critical | Frontend | Day 1~2 | - | 5절, 12절 |
| FE-02 | 환경 변수 설정 (VITE_API_URL, VITE_KAKAO_JS_KEY) | High | Frontend | Day 2 | FE-01 | 13절 |
| FE-03 | Zustand 스토어 설계 (auth, chat 히스토리, SSE 연결 상태) | High | Frontend | Day 2 | FE-01 | 5절 |
| FE-04 | 메인 채팅 화면 레이아웃 (상단: 로고+소개+로그인 / 중앙: 채팅 / 하단: 입력+레벨+카테고리) | Critical | Frontend | Day 4 | FE-01 | 15.1절 |
| FE-05 | 상단 — 로고 + 서비스 한 줄 소개 | Medium | Frontend | Day 4 | FE-04 | 15.1절 |
| FE-06 | 팩폭 레벨 슬라이더 (순한맛 / 매운맛 / 핵불닭맛) | High | Frontend | Day 4 | FE-04 | 4.2절 |
| FE-07 | 카테고리 선택 UI (커리어/연애/재정/자기개발/기타) | High | Frontend | Day 4 | FE-04 | 4.4절 |
| FE-08 | useSSE 커스텀 훅 — EventSource + 8가지 이벤트 파싱 | Critical | Frontend | Day 4 | FE-03 | 8.2절 |
| FE-09 | 채팅 자동 스크롤 — 토큰 스트리밍 시 최신 메시지로 | High | Frontend | Day 4 | FE-08 | |
| FE-10 | 에이전트 상태 표시 (status → "검색 중...", "팩폭 생성 중..." 로딩 UI) | High | Frontend | Day 4 | FE-08 | 9절 |
| FE-11 | diagnosis 섹션 UI — 빨간색/경고 톤 카드 | High | Frontend | Day 4 | FE-08 | 9절 |
| FE-12 | factcheck 섹션 UI — 데이터/통계 강조, 인용 스타일 | High | Frontend | Day 4 | FE-08 | 9절 |
| FE-13 | actionplan 섹션 UI — 번호 매겨진 리스트 (3가지) | High | Frontend | Day 4 | FE-08 | 9절 |
| FE-14 | crisis UI — 따뜻한 톤 + 전문 상담 핫라인 안내 | Critical | Frontend | Day 4 | FE-08 | 3.1절, 4.7절 |
| FE-15 | error UI — 에러/타임아웃 시 안내 메시지 | High | Frontend | Day 4 | FE-08 | 8.2절 |
| FE-16 | 입력 검증 (빈 메시지 방지, 최대 길이) + 중복 전송 방지 (SSE 중 버튼 비활성화) | High | Frontend | Day 4 | FE-04, FE-08 | |
| FE-17 | 새 대화 시작 (세션 생성 API → 채팅 초기화) | High | Frontend | Day 4 | FE-03, BE-07 | |
| FE-18 | 비로그인 접근 제어 — 미인증 시 채팅 차단 + 로그인 유도 | High | Frontend | Day 4 | AU-03 | |
| FE-19 | 현실회피지수 시각화 — 도넛/바 차트 + 5개 항목 브레이크다운 | High | Frontend | Day 5 | FE-08 | 9절 |
| FE-20 | SNS 공유 카드 — 팩폭 요약 + 점수 + 액션플랜 3개 | Medium | Frontend | Day 5 | FE-19 | 15.2절 |
| FE-21 | html2canvas → PNG 변환 + 이미지 저장 | Medium | Frontend | Day 5 | FE-20 | 4.6절 |
| FE-22 | 공유 카드 URL 복사 | Low | Frontend | Day 5 | FE-20 | 4.6절 |
| FE-23 | 이전 대화 히스토리 로드 (GET /api/chat/{id} → 렌더링) | Medium | Frontend | Day 5 | BE-16, FE-08 | 새로고침 시 유실 방지 |
| FE-24 | 반응형(모바일) UI | Medium | Frontend | Day 5 | FE-04 | 5절 |

### 인증

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| AU-01 | 카카오 개발자 콘솔 앱 등록 — Redirect URI + 동의항목 + 플랫폼(웹) | Critical | Backend | Day 1 | - | |
| AU-02 | 카카오 JS SDK 연동 + "카카오로 시작하기" 버튼 | Critical | Frontend | Day 3~4 | BE-05 | 4.5.1절 |
| AU-03 | 인가 코드 → POST /api/auth/kakao → JWT 수신 | Critical | Frontend | Day 3~4 | AU-02, BE-05 | 4.5.1절 |
| AU-04 | JWT → Zustand + localStorage 저장 + Bearer 헤더 | Critical | Frontend | Day 3~4 | AU-03 | 4.5.1절 |
| AU-05 | 로그인/로그아웃 UI + JWT 만료(24h) 시 재로그인 유도 (401 → 리다이렉트) | High | Frontend | Day 4 | AU-04 | 15.1절 |

### 테스트/QA

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| QA-01 | crisis_check — 키워드 + 우회 표현 시나리오 검증 | Critical | AI | Day 5~6 | AG-03 | 매우 높은 영향도 |
| QA-02 | 팩폭 레벨별 응답 톤 검증 | High | AI | Day 5~6 | AG-06 | |
| QA-03 | 카테고리별 시나리오 테스트 (각 1개 이상) | High | AI | Day 6 | AG-08 | 시연 영상용 포함 |
| QA-04 | 현실회피지수 점수 분포 합리성 확인 | High | AI | Day 5~6 | AG-12 | |
| QA-05 | SSE E2E 테스트 (프론트 ↔ Node ↔ Python) | Critical | All | Day 6 | BE-08, FE-08 | |
| QA-06 | 카카오 로그인 E2E | High | Frontend | Day 6 | AU-04 | |
| QA-07 | 타임아웃/에러 핸들링 (60초 초과, Function 실패, Tavily 에러) | Medium | Backend | Day 6 | BE-19 | |
| QA-08 | 공유 카드 이미지 렌더링 테스트 | Medium | Frontend | Day 6 | FE-21 | |
| QA-09 | 최종 버그픽스 | Critical | All | Day 7 | - | |

### 영상/제출

| ID | 태스크 | 우선순위 | 담당 | 스프린트 | 의존성 | 비고 |
|----|--------|----------|------|----------|--------|------|
| VD-01 | 시연 스크립트 — 3분 (소개 → 커리어+레벨변경 → 연애 → 현실회피지수+공유카드 → 위기감지) | High | All | Day 5~6 | - | 17.2절 |
| VD-02 | OBS 녹화 (1080p, MP4) | Critical | All | Day 6 | QA-05 | 17.1절 |
| VD-03 | CapCut/Vrew 편집 + 자막 | High | All | Day 6~7 | VD-02 | 17.1절 |
| VD-04 | 최종 제출 | Critical | All | Day 7 | VD-03, QA-09 | |

---

## 일정별 담당자 매트릭스

| 날짜 | 구분 | Backend | Frontend | AI |
|------|------|---------|----------|----|
| Day 1 (2/13) | 기획+세팅 | GitHub 모노레포, API 키 발급, 카카오 콘솔 앱 등록 | React+Vite+TS 초기 세팅 | - |
| Day 2 (2/14) | ★스펙 합의 + 설계 | ★ 전체 스펙 합의 (IF-03), Express 초기 세팅, Prisma 스키마 + DB, CORS + 환경 변수 | ★ 전체 스펙 합의 (IF-03), 환경 변수, Zustand 스토어 | ★ 전체 스펙 합의 (IF-03), FastAPI 초기 세팅, LangGraph 그래프 구조, crisis_check + 위기 응답, 시스템 프롬프트 + 레벨별 변형, Function 정의 + select_tools |
| Day 3 (2/15) | 핵심 구현 | 카카오 OAuth + JWT, 세션 생성 API, /api/chat SSE 중계 (메모리 버퍼), SSE 파싱 + done 트랜잭션, user 저장 + 히스토리 조립, 조회/공유 API + Dockerfile | 카카오 로그인 (AU-02~04), JWT 만료 재로그인, 비로그인 접근 제어 | reality_score + share_card, FastAPI SSE 엔드포인트, SSE 이벤트 (순서 포함), crisis/error 이벤트, OpenAI 검열 대응, AI 인증 + Dockerfile, 응답 3단 구조 강제 |
| Day 4 (2/16) | 프론트 핵심 | 헬스체크 + 타임아웃 60초, SSE 끊김 처리 + error 로깅 | 채팅 레이아웃 + 로고/소개, useSSE 훅 + 자동 스크롤, 상태 표시 + section UI 3종, crisis/error UI, 레벨 슬라이더 + 카테고리, 새 대화 + 입력검증 + 중복방지, 로그인/로그아웃 UI | 레벨별 프롬프트 튜닝, 카테고리 판별 로직 |
| Day 5 (2/17) | 디자인+보완 | 배포 환경 구성, 사용량 제한/캐싱 | 현실회피지수 시각화, 공유 카드 + html2canvas, 히스토리 로드 + 반응형, UI/UX 디자인 | 폴백 + Tavily 추적, 현실회피지수 정확도, 시나리오 튜닝 |
| Day 6 (2/18) | 통합+영상 | Railway 배포 + 내부 통신, E2E 통합 테스트 | Cloudflare 배포, E2E + 공유카드 테스트 | crisis/레벨/카테고리 테스트 |
| Day 7 (2/19~20) | 마무리 | 최종 버그픽스 | 최종 버그픽스 | 최종 프롬프트 조정 |
